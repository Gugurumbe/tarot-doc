<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Tarot: /client/ai/ia.pro</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">Tarot
   </div>
   <div id="projectbrief">PE 46 à l&#39;ECL</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Généré par Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Recherche');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Page&#160;principale</span></a></li>
      <li><a href="pages.html"><span>Pages&#160;associées</span></a></li>
      <li><a href="namespaces.html"><span>Espaces&#160;de&#160;nommage</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Fichiers</span></a></li>
      <li><a href="examples.html"><span>Exemples</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Recherche" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>Tout</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Classes</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Espaces de nommage</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Fichiers</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Fonctions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Énumérations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Valeurs énumérées</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">/client/ai/ia.pro</div>  </div>
</div><!--header-->
<div class="contents">
<p>Maintenant, on peut travailler. Faites un fichier principal (ici, main_program.cpp), ici :</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;QCoreApplication&gt;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//Sert uniquement à définir AUTO_ADDR et AUTO_PORT</span></div>
<div class="line"><span class="preprocessor">#include &quot;./config.hpp&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//Classe D&#39;IA</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ia_8hpp.html">ia.hpp</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//Fonction principale</span></div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> * argv[])</div>
<div class="line">{</div>
<div class="line">  QCoreApplication app(argc, argv);</div>
<div class="line">  <span class="comment">//Création d&#39;une IA</span></div>
<div class="line">  <a name="_a0"></a><a class="code" href="classIA.html">IA</a> * ia = <span class="keyword">new</span> <a class="code" href="classIA.html">IA</a>;</div>
<div class="line">  <span class="comment">//Dit au CLientJeu sous-jacent de se connecter</span></div>
<div class="line">  ia-&gt;<a name="a1"></a><a class="code" href="classIA.html#abaa7525c357e47e53dd3a1d416dc6cec">connecter</a>(<a name="a2"></a><a class="code" href="client_2ai_2config_8hpp.html#aeb53e4cb507414654f1baef355d7b13b">AUTO_ADDR</a>, <a name="a3"></a><a class="code" href="client_2ai_2config_8hpp.html#ad1b13dd82aa38bb19b6be39178b99f31">AUTO_PORT</a>);</div>
<div class="line">  <span class="comment">//On tue l&#39;IA dès qu&#39;elle se déconnecte.</span></div>
<div class="line">  QObject::connect(ia, SIGNAL(destroyed()),</div>
<div class="line">                   &amp;app, SLOT(quit()));</div>
<div class="line">  <span class="keywordflow">return</span> app.exec();</div>
<div class="line">}</div>
</div><!-- fragment --><p>On voit que l'on a fait une classe externe, <a class="el" href="classIA.html" title="Classe d&#39;intelligence artificielle. ">IA</a>. Il suffit après de connecter les signaux d'information de <a class="el" href="classClientJeu.html" title="Spécialise la classe Client, en permettant de comprendre l&#39;environnement de jeu du tarot...">ClientJeu</a> aux slots de notre nouvelle classe. Ensuite, il faut appeler les slots ClientJeu::formuler_* pour interagir avec le serveur. Dans l'exemple, j'ai fait une <a class="el" href="classIA.html" title="Classe d&#39;intelligence artificielle. ">IA</a> dite "basique" :</p>
<div class="fragment"><div class="line"></div>
<div class="line"><span class="preprocessor">#ifndef IA_DEFINIE</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line"><span class="preprocessor">#define IA_DEFINIE</span></div>
<div class="line"><span class="preprocessor"></span><span class="preprocessor">#include &quot;<a class="code" href="client__jeu_8hpp.html">client_jeu.hpp</a>&quot;</span></div>
<div class="line"><span class="keyword">class </span><a class="code" href="classIA.html">IA</a> : <span class="keyword">public</span> QObject</div>
<div class="line">{</div>
<div class="line">  Q_OBJECT;</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a name="a4"></a><a class="code" href="classIA.html#a90c9d35eaef3b4ca6163003776e0eb09">IA</a>(QObject * parent = 0);</div>
<div class="line"><span class="keyword">public</span> slots:</div>
<div class="line">  <span class="keywordtype">void</span> <a class="code" href="classIA.html#abaa7525c357e47e53dd3a1d416dc6cec">connecter</a>(QHostAddress hote, quint16 port);</div>
<div class="line">  <span class="keywordtype">void</span> doit_priser(<a name="_a5"></a><a class="code" href="classOption.html">Option&lt;Enchere&gt;</a> plus_forte);</div>
<div class="line">  <span class="keywordtype">void</span> doit_jouer();</div>
<div class="line">  <span class="keywordtype">void</span> partie_terminee(std::vector&lt;int&gt; scores);</div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a name="_a6"></a><a class="code" href="classClientJeu.html">ClientJeu</a> jeu; <span class="comment">//TRÈS IMPORTANT : le ClientJeu sous-jacent !</span></div>
<div class="line">  <a name="_a7"></a><a class="code" href="classCarte.html">Carte</a> testee; <span class="comment">//La carte que j&#39;essaie de jouer.</span></div>
<div class="line">};</div>
<div class="line"><span class="preprocessor">#endif</span></div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="preprocessor">#include &quot;<a class="code" href="ia_8hpp.html">ia.hpp</a>&quot;</span></div>
<div class="line"></div>
<div class="line"><a class="code" href="classIA.html#a90c9d35eaef3b4ca6163003776e0eb09">IA::IA</a>(QObject * parent): QObject(parent),</div>
<div class="line">                          jeu(this), </div>
<div class="line">                          testee(0) <span class="comment">//On commence par essayer de jouer</span></div>
<div class="line">                                    <span class="comment">//le deux de pique (cf doit_jouer)</span></div>
<div class="line">{</div>
<div class="line">  <span class="comment">//Pour plus de commodité :</span></div>
<div class="line"><span class="preprocessor">#define C(signal) \</span></div>
<div class="line"><span class="preprocessor">  QObject::connect(&amp;jeu, SIGNAL(signal), this, SLOT(signal));</span></div>
<div class="line"><span class="preprocessor"></span></div>
<div class="line">  <span class="comment">//C&#39;est plus facile de connecter les signaux du ClientJeu aux slots</span></div>
<div class="line">  <span class="comment">//du même nom.</span></div>
<div class="line">  C(doit_priser(<a class="code" href="classOption.html">Option&lt;Enchere&gt;</a>));</div>
<div class="line">  C(doit_jouer());</div>
<div class="line">  C(partie_terminee(std::vector&lt;int&gt;));</div>
<div class="line">}</div>
<div class="line"><span class="comment">// Fonction appelée dans main_program.cpp</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code" href="classIA.html#abaa7525c357e47e53dd3a1d416dc6cec">IA::connecter</a>(QHostAddress hote, quint16 port)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">//Simple comme bonjour :</span></div>
<div class="line">  jeu.<a name="a8"></a><a class="code" href="classClient.html#aca6f6439d8500cea98b540450450e8cd">connecter</a>(hote, port);</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> IA::doit_priser(<a class="code" href="classOption.html">Option&lt;Enchere&gt;</a>)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">//Je dois priser. Comme je suis une IA basique, je passe.</span></div>
<div class="line">  jeu.<a name="a9"></a><a class="code" href="classClientJeu.html#a98689343a93362c3b583a27e1ef6543f">formuler_prise</a>(<a name="a10"></a><a class="code" href="classEnchere.html#a1dfe2ab8eb7d4b82786201f95c453a3faa40cabb8cd6ac3bed25b69561ebb834f">Enchere::PASSE</a>);</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> IA::doit_jouer()</div>
<div class="line">{</div>
<div class="line">  <span class="comment">//Je dois jouer. Je commence par changer de carte :</span></div>
<div class="line">  <a class="code" href="classCarte.html">Carte</a> suivante((testee.<a name="a11"></a><a class="code" href="classCarte.html#a71b2fa7ab34086aed44b3430b3755df5">numero</a>() + 1) % 78);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">//Je fais dire au serveur que je veux jouer cette carte :</span></div>
<div class="line">  jeu.<a name="a12"></a><a class="code" href="classClientJeu.html#ad47142bad1f216ac3b93d0b75cf0b559">formuler_requete</a>(suivante);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">//Je m&#39;en souviens pour le prochain refus (et donc, le prochain</span></div>
<div class="line">  <span class="comment">//doit_jouer) </span></div>
<div class="line">  testee = suivante;</div>
<div class="line">}</div>
<div class="line"><span class="keywordtype">void</span> IA::partie_terminee(std::vector&lt;int&gt;)</div>
<div class="line">{</div>
<div class="line">  <span class="comment">//La partie est terminée, j&#39;arrête le programme. Le moyen le plus</span></div>
<div class="line">  <span class="comment">//simple est de détruire le QObject (voir main_program.cpp)</span></div>
<div class="line">  deleteLater();</div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="conclusion"></a>
Conclusion</h1>
<p>Il y a un protocole à respecter pour communiquer avec le serveur, et pour utiliser les classes existantes, il faut se mettre au bon endroit, compiler les bons fichiers, utilier la dépendance netork, de déclarer une variable de type <a class="el" href="classClientJeu.html" title="Spécialise la classe Client, en permettant de comprendre l&#39;environnement de jeu du tarot...">ClientJeu</a>.</p>
<div class="fragment"><div class="line">TEMPLATE = app</div>
<div class="line">TARGET = ia</div>
<div class="line">DEPENDPATH += .</div>
<div class="line">INCLUDEPATH += . ../shared ../../shared</div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Input</span></div>
<div class="line"><span class="preprocessor"></span>HEADERS +=                                          \</div>
<div class="line">ia.hpp                                              \</div>
<div class="line">../shared/client.hpp                                \</div>
<div class="line">../shared/client_jeu.hpp                            \</div>
<div class="line">../shared/option.hpp                                \</div>
<div class="line">../shared/partie_client.hpp                         \</div>
<div class="line">../shared/transaction.hpp                           \</div>
<div class="line">../../shared/carte.hpp                              \</div>
<div class="line">../../shared/deboguer.hpp                           \</div>
<div class="line">../../shared/debogueur.hpp                          \</div>
<div class="line">../../shared/enchere.hpp                            \</div>
<div class="line">../../shared/main.hpp                               \</div>
<div class="line">../../shared/ne_pas_deboguer.hpp                    \</div>
<div class="line">../../shared/partie.hpp                             \</div>
<div class="line">../../shared/protocole.hpp                          \</div>
<div class="line">../../shared/tapis.hpp       </div>
<div class="line"></div>
<div class="line"><span class="preprocessor"># Sources</span></div>
<div class="line"><span class="preprocessor"></span>SOURCES +=                                          \</div>
<div class="line">ia.cpp                                              \
main_program.cpp                                    \</div>
<div class="line">../shared/client.cpp                                \</div>
<div class="line">../shared/client_jeu.cpp                            \</div>
<div class="line">../shared/option.cpp                                \</div>
<div class="line">../shared/partie_client.cpp                         \</div>
<div class="line">../shared/transaction.cpp                           \</div>
<div class="line">../../shared/carte.cpp                              \</div>
<div class="line">../../shared/debogueur.cpp                          \</div>
<div class="line">../../shared/enchere.cpp                            \</div>
<div class="line">../../shared/main.cpp                               \</div>
<div class="line">../../shared/partie.cpp                             \</div>
<div class="line">../../shared/protocole.cpp                          \</div>
<div class="line">../../shared/tapis.cpp       </div>
<div class="line"></div>
<div class="line">QT += network</div>
<div class="line"></div><!-- fragment --> </div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Généré le Mercredi 17 Décembre 2014 21:09:44 pour Tarot par &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.6
</small></address>
</body>
</html>
